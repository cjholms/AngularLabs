<h2>Receiving Products</h2>
<div class="alert alert-success">
  <p>Welcome, {{ user.givenName }} {{ user.familyName }}!</p>
  <p>Order status</p>
</div>
<div class="alert alert-info">
  <h3>Instructions</h3>
  <ol>
    <li>Scan or enter a tracking number.</li>
    <li>Enter a product ID if you know it or begin entering a description and choose from options</li>
    <li>Enter the number of items and check the <i>Got it</i> box.</li>
    <li>After you've picked, packed, and shipped your last item, click <i>Finished receiving</i></li>
  </ol>
  <p> If there's a problem and you need a supervisor to look at it, hit the "Problem" button.</p>
</div>
<section id="trackingInfo" [ngClass]="
{
  'bg-success' : trackingNumberTR.touched && trackingNumberTR.valid,
  'text-success' : trackingNumberTR.touched && trackingNumberTR.valid,
  'bg-danger' : trackingNumberTR.touched && trackingNumberTR.invalid,
  'text-danger' : trackingNumberTR.touched && trackingNumberTR.invalid
}">
  <div class="control-group">
    <label class="control-label" for="trackingNumber">Tracking number</label>
    <input name="trackingNumber" #trackingNumberTR="ngModel" [(ngModel)]="trackingNumber" class="form-control"
      id="trackingNumber" required pattern="^\d[A-Z]\d{16}$|^\d{14,15}$|^9[2-4]\d{2}( ?\d{4}){4} ?\d{2}$" />
  </div>
  <button class="btn btn-primary btn-large" (click)="saveTrackingNumber()">Continue</button>
</section>
<div *ngIf="showForm">
  <section class="well" id="productInfo">
    <div class="control-group">
      <label class="control-label" for="productName">Product Name</label>
      <input class="form-control" id="productName">
    </div>
    <div class="list-group" id="productList">
      <button class="list-group-item">A placeholder product</button>
      <button class="list-group-item">Another placeholder product</button>
      <button class="list-group-item">Yet another product</button>
    </div>
    <p>... OR ...</p>
    <div class="control-group">
      <label class="control-label" for="productID">Product ID</label>
      <input name="productID" #productID class="form-control" id="productID"
        (blur)="lookupProduct(productID.value)">
    </div>
    <div class="control-group">
      <label class="control-label" for="quantity">Quantity Received</label>
      <input name="quantity" #quantity class="form-control" id="quantity" step="1" type="number">
    </div>
    <table *ngIf="productID.value" [ngClass]="
    {
      'table' : 'true',
      'bg-danger' : !isKnownProduct
    }">
      <thead>
        <tr>
          <th>Image</th>
          <th>ID</th>
          <th>Name</th>
          <th>Quantity</th>
          <th>Location</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><img src="{{ product?.imageUrl }}"/></td>
          <td>{{ product?.id }}</td>
          <td>{{ product?.name }}</td>
          <td></td>
          <td>{{ location?.id | locationExpand }}</td>
        </tr>
      </tbody>
    </table>

    <div class="control-group">
      <input class="btn btn-primary" type="submit" value="Receive product" [disabled]="!isKnownProduct"
        (click)="receiveProduct(quantity.value); productID.value=''; quantity.value=''" />
    </div>
  </section>
  <section id="orderContents">
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Image</th>
          <th>ID</th>
          <th>Name</th>
          <th>Quantity</th>
          <th>Location</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of receiveProducts">
          <td><img src="{{ item.product?.imageUrl }}"/></td>
          <td>{{ item.product?.id }}</td>
          <td>{{ item.product?.name }}</td>
          <td>{{ item.quantity }}</td>
          <td>{{ item.location?.id | locationExpand }}</td>
        </tr>
      </tbody>
    </table>
  </section>
  <section>
    <button class="btn btn-lg" (click)="finishedReceiving()">Finished receiving</button>
  </section>
</div>